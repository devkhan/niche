<html>
	<head>
		<!-- Bootstrap dependencies for the menu and buttons. jQuery for DOM manipulation. -->
		<script src="jquery.min.js"></script>
		<script src="bootstrap/js/bootstrap.min.js"></script>
		<link rel="stylesheet" href="bootstrap/css/bootstrap.min.css"/>
		<link rel="stylesheet" href="bootstrap/css/bootstrap-theme.min.css" />

		<style type="text/css">
			#container {
			max-width: 100%;
			height: 100%;
			margin: auto;
			}
		</style>
	</head>

	<body>
	
		<div id="container"></div>

		<script src="sigma/sigma.min.js"></script>
		<script src="sigma/plugins/sigma.parsers.json.min.js"></script>
		<script src="sigma/plugins/sigma.layout.forceAtlas2.min.js"></script>

		<script>
		
			var cobraModel, mapData = {};
			$.getJSON('E coli core.json', function(data) {
				// Data(CoBRA Model) recieved from URL.
				cobraModel = data;
				console.log("COBRA model retreived successfully. Id: " + cobraModel['id']);

				mapData['nodes'] = [];
				var metaboliteCount = 0;
				cobraModel['metabolites'].forEach(function(metabolite){
					metaboliteCount++;
					mapData['nodes'].push({
						"id": metabolite['id'],
						"label": metabolite['name'],
						"size": Math.abs(metabolite['charge'])+1,
						"x": 100 * Math.cos(2 * Math.random() * cobraModel['metabolites'].length * Math.PI / cobraModel['metabolites'].length),
						"y": 100 * Math.sin(2 * Math.random() * cobraModel['metabolites'].length * Math.PI / cobraModel['metabolites'].length),
					});

				});

				mapData['edges'] = [];
				var reactionCount = 0, edgeCount = 0;
				cobraModel['reactions'].forEach(function(reaction){
					mapData['nodes'].push({
						"id": reaction['id'],
						"label": reaction['name'],
						"size": 1,
						"x": 100 * Math.sin(2 * Math.random() * cobraModel['metabolites'].length * Math.PI / cobraModel['metabolites'].length),
						"y": 100 * Math.cos(2 * Math.random() * cobraModel['metabolites'].length * Math.PI / cobraModel['metabolites'].length),
					});
					for(var key in reaction['metabolites']) {
						if (reaction['metabolites'].hasOwnProperty(key)) {
							mapData['edges'].push({
								"id": reaction['id'] + "." + key,
								"label": reaction['name'],
								"source": key,
								"target": reaction['id'],
								"type": "curve"
							});
							edgeCount++;
						};
					}
					reactionCount++;
				});
/*
				mapData = {
					"nodes": [{
						"id": "n0",
						"label": "A node",
						"x": 0,
						"y": 0,
						"size": 3
					}, {
						"id": "n1",
						"label": "Another node",
						"x": 3,
						"y": 1,
						"size": 2
					}, {
						"id": "n2",
						"label": "And a last one",
						"x": 1,
						"y": 3,
						"size": 1
					}],
					"edges": [{
						"id": "e0",
						"source": "n0",
						"target": "n1"
					}, {
						"id": "e1",
						"source": "n1",
						"target": "n2"
					}, {
						"id": "e2",
						"source": "n2",
						"target": "n0"
					}]
				};
*/
				s = new sigma({
					graph: mapData,
					container: 'container',
					settings: {
						defaultNodeColor: '#ec5148',
						verbose: true
					}
				});

				console.log(mapData);
				/*s.startForceAtlas2({
					strongGravityMode: true
				});*/
			});
			
			
		</script>
	</body>
</html>